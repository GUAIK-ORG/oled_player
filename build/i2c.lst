ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 1


   1              		.cpu cortex-m3
   2              		.arch armv7-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"i2c.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.I2C_GPIO_Init,"ax",%progbits
  18              		.align	1
  19              		.global	I2C_GPIO_Init
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  24              	I2C_GPIO_Init:
  25              	.LFB32:
  26              		.file 1 "BASIC/i2c/i2c.c"
   1:BASIC/i2c/i2c.c **** #include "i2c.h"
   2:BASIC/i2c/i2c.c **** 
   3:BASIC/i2c/i2c.c **** #include <stm32f10x_i2c.h>
   4:BASIC/i2c/i2c.c **** #include <stm32f10x_rcc.h>
   5:BASIC/i2c/i2c.c **** #include <usart/usart.h>
   6:BASIC/i2c/i2c.c **** 
   7:BASIC/i2c/i2c.c **** void I2C_GPIO_Init(void) {
  27              		.loc 1 7 26 view -0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 8
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31 0000 00B5     		push	{lr}
  32              	.LCFI0:
  33              		.cfi_def_cfa_offset 4
  34              		.cfi_offset 14, -4
  35 0002 83B0     		sub	sp, sp, #12
  36              	.LCFI1:
  37              		.cfi_def_cfa_offset 16
   8:BASIC/i2c/i2c.c ****   GPIO_InitTypeDef GPIO_InitStructure;
  38              		.loc 1 8 3 view .LVU1
   9:BASIC/i2c/i2c.c ****   RCC_APB2PeriphClockCmd(
  39              		.loc 1 9 3 view .LVU2
  40 0004 0121     		movs	r1, #1
  41 0006 1C20     		movs	r0, #28
  42 0008 FFF7FEFF 		bl	RCC_APB2PeriphClockCmd
  43              	.LVL0:
  10:BASIC/i2c/i2c.c ****       RCC_APB2Periph_GPIOA | RCC_APB2Periph_GPIOB | RCC_APB2Periph_GPIOC,
  11:BASIC/i2c/i2c.c ****       ENABLE);
  12:BASIC/i2c/i2c.c ****   RCC_APB1PeriphClockCmd(RCC_APB1Periph_I2C1, ENABLE);  // 启动I2C功能
  44              		.loc 1 12 3 view .LVU3
  45 000c 0121     		movs	r1, #1
  46 000e 4FF40010 		mov	r0, #2097152
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 2


  47 0012 FFF7FEFF 		bl	RCC_APB1PeriphClockCmd
  48              	.LVL1:
  13:BASIC/i2c/i2c.c ****   GPIO_InitStructure.GPIO_Pin = I2C_SCL | I2C_SDA;
  49              		.loc 1 13 3 view .LVU4
  50              		.loc 1 13 31 is_stmt 0 view .LVU5
  51 0016 C023     		movs	r3, #192
  52 0018 ADF80430 		strh	r3, [sp, #4]	@ movhi
  14:BASIC/i2c/i2c.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF_OD;
  53              		.loc 1 14 3 is_stmt 1 view .LVU6
  54              		.loc 1 14 32 is_stmt 0 view .LVU7
  55 001c 1C23     		movs	r3, #28
  56 001e 8DF80730 		strb	r3, [sp, #7]
  15:BASIC/i2c/i2c.c ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_50MHz;
  57              		.loc 1 15 3 is_stmt 1 view .LVU8
  58              		.loc 1 15 33 is_stmt 0 view .LVU9
  59 0022 0323     		movs	r3, #3
  60 0024 8DF80630 		strb	r3, [sp, #6]
  16:BASIC/i2c/i2c.c ****   GPIO_Init(I2CPORT, &GPIO_InitStructure);
  61              		.loc 1 16 3 is_stmt 1 view .LVU10
  62 0028 01A9     		add	r1, sp, #4
  63 002a 0348     		ldr	r0, .L3
  64 002c FFF7FEFF 		bl	GPIO_Init
  65              	.LVL2:
  17:BASIC/i2c/i2c.c **** }
  66              		.loc 1 17 1 is_stmt 0 view .LVU11
  67 0030 03B0     		add	sp, sp, #12
  68              	.LCFI2:
  69              		.cfi_def_cfa_offset 4
  70              		@ sp needed
  71 0032 5DF804FB 		ldr	pc, [sp], #4
  72              	.L4:
  73 0036 00BF     		.align	2
  74              	.L3:
  75 0038 000C0140 		.word	1073810432
  76              		.cfi_endproc
  77              	.LFE32:
  79              		.section	.text.I2C_Configuration,"ax",%progbits
  80              		.align	1
  81              		.global	I2C_Configuration
  82              		.syntax unified
  83              		.thumb
  84              		.thumb_func
  86              	I2C_Configuration:
  87              	.LFB33:
  18:BASIC/i2c/i2c.c **** 
  19:BASIC/i2c/i2c.c **** void I2C_Configuration(void) {
  88              		.loc 1 19 30 is_stmt 1 view -0
  89              		.cfi_startproc
  90              		@ args = 0, pretend = 0, frame = 16
  91              		@ frame_needed = 0, uses_anonymous_args = 0
  92 0000 10B5     		push	{r4, lr}
  93              	.LCFI3:
  94              		.cfi_def_cfa_offset 8
  95              		.cfi_offset 4, -8
  96              		.cfi_offset 14, -4
  97 0002 84B0     		sub	sp, sp, #16
  98              	.LCFI4:
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 3


  99              		.cfi_def_cfa_offset 24
  20:BASIC/i2c/i2c.c ****   I2C_InitTypeDef I2C_InitStructure;
 100              		.loc 1 20 3 view .LVU13
  21:BASIC/i2c/i2c.c ****   I2C_GPIO_Init();                                    // 先设置GPIO状态
 101              		.loc 1 21 3 view .LVU14
 102 0004 FFF7FEFF 		bl	I2C_GPIO_Init
 103              	.LVL3:
  22:BASIC/i2c/i2c.c ****   I2C_InitStructure.I2C_Mode = I2C_Mode_I2C;          // 设置为I2C模式
 104              		.loc 1 22 3 view .LVU15
 105              		.loc 1 22 30 is_stmt 0 view .LVU16
 106 0008 0023     		movs	r3, #0
 107 000a ADF80430 		strh	r3, [sp, #4]	@ movhi
  23:BASIC/i2c/i2c.c ****   I2C_InitStructure.I2C_DutyCycle = I2C_DutyCycle_2;  // 占空比
 108              		.loc 1 23 3 is_stmt 1 view .LVU17
 109              		.loc 1 23 35 is_stmt 0 view .LVU18
 110 000e 4BF6FF73 		movw	r3, #49151
 111 0012 ADF80630 		strh	r3, [sp, #6]	@ movhi
  24:BASIC/i2c/i2c.c ****   I2C_InitStructure.I2C_OwnAddress1 =
 112              		.loc 1 24 3 is_stmt 1 view .LVU19
 113              		.loc 1 24 37 is_stmt 0 view .LVU20
 114 0016 C023     		movs	r3, #192
 115 0018 ADF80830 		strh	r3, [sp, #8]	@ movhi
  25:BASIC/i2c/i2c.c ****       HostAddress;  // 主机地址（从机不得用此地址）
  26:BASIC/i2c/i2c.c ****   I2C_InitStructure.I2C_Ack = I2C_Ack_Enable;  // 允许应答
 116              		.loc 1 26 3 is_stmt 1 view .LVU21
 117              		.loc 1 26 29 is_stmt 0 view .LVU22
 118 001c 4FF48063 		mov	r3, #1024
 119 0020 ADF80A30 		strh	r3, [sp, #10]	@ movhi
  27:BASIC/i2c/i2c.c ****   I2C_InitStructure.I2C_AcknowledgedAddress =
 120              		.loc 1 27 3 is_stmt 1 view .LVU23
 121              		.loc 1 27 45 is_stmt 0 view .LVU24
 122 0024 4FF48043 		mov	r3, #16384
 123 0028 ADF80C30 		strh	r3, [sp, #12]	@ movhi
  28:BASIC/i2c/i2c.c ****       I2C_AcknowledgedAddress_7bit;  // 7位地址模式
  29:BASIC/i2c/i2c.c ****   I2C_InitStructure.I2C_ClockSpeed = BusSpeed;
 124              		.loc 1 29 3 is_stmt 1 view .LVU25
 125              		.loc 1 29 36 is_stmt 0 view .LVU26
 126 002c 064B     		ldr	r3, .L7
 127 002e 0093     		str	r3, [sp]
  30:BASIC/i2c/i2c.c ****   I2C_Init(I2C1, &I2C_InitStructure);
 128              		.loc 1 30 3 is_stmt 1 view .LVU27
 129 0030 064C     		ldr	r4, .L7+4
 130 0032 6946     		mov	r1, sp
 131 0034 2046     		mov	r0, r4
 132 0036 FFF7FEFF 		bl	I2C_Init
 133              	.LVL4:
  31:BASIC/i2c/i2c.c ****   I2C_Cmd(I2C1, ENABLE);
 134              		.loc 1 31 3 view .LVU28
 135 003a 0121     		movs	r1, #1
 136 003c 2046     		mov	r0, r4
 137 003e FFF7FEFF 		bl	I2C_Cmd
 138              	.LVL5:
  32:BASIC/i2c/i2c.c **** }
 139              		.loc 1 32 1 is_stmt 0 view .LVU29
 140 0042 04B0     		add	sp, sp, #16
 141              	.LCFI5:
 142              		.cfi_def_cfa_offset 8
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 4


 143              		@ sp needed
 144 0044 10BD     		pop	{r4, pc}
 145              	.L8:
 146 0046 00BF     		.align	2
 147              	.L7:
 148 0048 400D0300 		.word	200000
 149 004c 00540040 		.word	1073763328
 150              		.cfi_endproc
 151              	.LFE33:
 153              		.section	.text.I2C_SEND_BUFFER,"ax",%progbits
 154              		.align	1
 155              		.global	I2C_SEND_BUFFER
 156              		.syntax unified
 157              		.thumb
 158              		.thumb_func
 160              	I2C_SEND_BUFFER:
 161              	.LVL6:
 162              	.LFB34:
  33:BASIC/i2c/i2c.c **** void I2C_SEND_BUFFER(u8 slaveAddr, u8 writeAddr, u8* pBuffer,
  34:BASIC/i2c/i2c.c ****                      u16 numByteToWrite) {
 163              		.loc 1 34 42 is_stmt 1 view -0
 164              		.cfi_startproc
 165              		@ args = 0, pretend = 0, frame = 0
 166              		@ frame_needed = 0, uses_anonymous_args = 0
 167              		.loc 1 34 42 is_stmt 0 view .LVU31
 168 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 169              	.LCFI6:
 170              		.cfi_def_cfa_offset 24
 171              		.cfi_offset 3, -24
 172              		.cfi_offset 4, -20
 173              		.cfi_offset 5, -16
 174              		.cfi_offset 6, -12
 175              		.cfi_offset 7, -8
 176              		.cfi_offset 14, -4
 177 0002 0746     		mov	r7, r0
 178 0004 0C46     		mov	r4, r1
 179 0006 1646     		mov	r6, r2
 180 0008 1D46     		mov	r5, r3
  35:BASIC/i2c/i2c.c ****   I2C_GenerateSTART(I2C1, ENABLE);
 181              		.loc 1 35 3 is_stmt 1 view .LVU32
 182 000a 0121     		movs	r1, #1
 183              	.LVL7:
 184              		.loc 1 35 3 is_stmt 0 view .LVU33
 185 000c 1948     		ldr	r0, .L17
 186              	.LVL8:
 187              		.loc 1 35 3 view .LVU34
 188 000e FFF7FEFF 		bl	I2C_GenerateSTART
 189              	.LVL9:
  36:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 190              		.loc 1 36 3 is_stmt 1 view .LVU35
 191              	.L10:
  37:BASIC/i2c/i2c.c ****     ;
 192              		.loc 1 37 5 discriminator 1 view .LVU36
  36:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 193              		.loc 1 36 9 discriminator 1 view .LVU37
  36:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 194              		.loc 1 36 11 is_stmt 0 discriminator 1 view .LVU38
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 5


 195 0012 1949     		ldr	r1, .L17+4
 196 0014 1748     		ldr	r0, .L17
 197 0016 FFF7FEFF 		bl	I2C_CheckEvent
 198              	.LVL10:
  36:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 199              		.loc 1 36 9 discriminator 1 view .LVU39
 200 001a 0028     		cmp	r0, #0
 201 001c F9D0     		beq	.L10
  38:BASIC/i2c/i2c.c ****   I2C_Send7bitAddress(I2C1, slaveAddr, I2C_Direction_Transmitter);
 202              		.loc 1 38 3 is_stmt 1 view .LVU40
 203 001e 0022     		movs	r2, #0
 204 0020 3946     		mov	r1, r7
 205 0022 1448     		ldr	r0, .L17
 206 0024 FFF7FEFF 		bl	I2C_Send7bitAddress
 207              	.LVL11:
  39:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))
 208              		.loc 1 39 3 view .LVU41
 209              	.L11:
  40:BASIC/i2c/i2c.c ****     ;
 210              		.loc 1 40 5 discriminator 1 view .LVU42
  39:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))
 211              		.loc 1 39 9 discriminator 1 view .LVU43
  39:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))
 212              		.loc 1 39 11 is_stmt 0 discriminator 1 view .LVU44
 213 0028 1449     		ldr	r1, .L17+8
 214 002a 1248     		ldr	r0, .L17
 215 002c FFF7FEFF 		bl	I2C_CheckEvent
 216              	.LVL12:
  39:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))
 217              		.loc 1 39 9 discriminator 1 view .LVU45
 218 0030 0028     		cmp	r0, #0
 219 0032 F9D0     		beq	.L11
  41:BASIC/i2c/i2c.c ****   I2C_SendData(I2C1, writeAddr);
 220              		.loc 1 41 3 is_stmt 1 view .LVU46
 221 0034 2146     		mov	r1, r4
 222 0036 0F48     		ldr	r0, .L17
 223 0038 FFF7FEFF 		bl	I2C_SendData
 224              	.LVL13:
  42:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 225              		.loc 1 42 3 view .LVU47
 226              	.L12:
  43:BASIC/i2c/i2c.c ****     ;
 227              		.loc 1 43 5 discriminator 1 view .LVU48
  42:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 228              		.loc 1 42 9 discriminator 1 view .LVU49
  42:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 229              		.loc 1 42 11 is_stmt 0 discriminator 1 view .LVU50
 230 003c 1049     		ldr	r1, .L17+12
 231 003e 0D48     		ldr	r0, .L17
 232 0040 FFF7FEFF 		bl	I2C_CheckEvent
 233              	.LVL14:
  42:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 234              		.loc 1 42 9 discriminator 1 view .LVU51
 235 0044 0028     		cmp	r0, #0
 236 0046 F9D0     		beq	.L12
 237              	.LBB2:
  44:BASIC/i2c/i2c.c ****   for (u8 i = 0; i < numByteToWrite; i++) {
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 6


 238              		.loc 1 44 11 view .LVU52
 239 0048 0024     		movs	r4, #0
 240 004a 0BE0     		b	.L13
 241              	.LVL15:
 242              	.L15:
  45:BASIC/i2c/i2c.c ****     I2C_SendData(I2C1, *(pBuffer + i));
 243              		.loc 1 45 5 is_stmt 1 view .LVU53
 244 004c 315D     		ldrb	r1, [r6, r4]	@ zero_extendqisi2
 245 004e 0948     		ldr	r0, .L17
 246 0050 FFF7FEFF 		bl	I2C_SendData
 247              	.LVL16:
  46:BASIC/i2c/i2c.c ****     while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 248              		.loc 1 46 5 view .LVU54
 249              	.L14:
  47:BASIC/i2c/i2c.c ****       ;
 250              		.loc 1 47 7 discriminator 1 view .LVU55
  46:BASIC/i2c/i2c.c ****     while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 251              		.loc 1 46 11 discriminator 1 view .LVU56
  46:BASIC/i2c/i2c.c ****     while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 252              		.loc 1 46 13 is_stmt 0 discriminator 1 view .LVU57
 253 0054 0A49     		ldr	r1, .L17+12
 254 0056 0748     		ldr	r0, .L17
 255 0058 FFF7FEFF 		bl	I2C_CheckEvent
 256              	.LVL17:
  46:BASIC/i2c/i2c.c ****     while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 257              		.loc 1 46 11 discriminator 1 view .LVU58
 258 005c 0028     		cmp	r0, #0
 259 005e F9D0     		beq	.L14
  44:BASIC/i2c/i2c.c ****     I2C_SendData(I2C1, *(pBuffer + i));
 260              		.loc 1 44 38 is_stmt 1 discriminator 2 view .LVU59
  44:BASIC/i2c/i2c.c ****     I2C_SendData(I2C1, *(pBuffer + i));
 261              		.loc 1 44 39 is_stmt 0 discriminator 2 view .LVU60
 262 0060 0134     		adds	r4, r4, #1
 263              	.LVL18:
  44:BASIC/i2c/i2c.c ****     I2C_SendData(I2C1, *(pBuffer + i));
 264              		.loc 1 44 39 discriminator 2 view .LVU61
 265 0062 E4B2     		uxtb	r4, r4
 266              	.LVL19:
 267              	.L13:
  44:BASIC/i2c/i2c.c ****     I2C_SendData(I2C1, *(pBuffer + i));
 268              		.loc 1 44 18 is_stmt 1 discriminator 1 view .LVU62
  44:BASIC/i2c/i2c.c ****     I2C_SendData(I2C1, *(pBuffer + i));
 269              		.loc 1 44 20 is_stmt 0 discriminator 1 view .LVU63
 270 0064 A1B2     		uxth	r1, r4
  44:BASIC/i2c/i2c.c ****     I2C_SendData(I2C1, *(pBuffer + i));
 271              		.loc 1 44 3 discriminator 1 view .LVU64
 272 0066 A942     		cmp	r1, r5
 273 0068 F0D3     		bcc	.L15
 274              	.LBE2:
  48:BASIC/i2c/i2c.c ****   }
  49:BASIC/i2c/i2c.c ****   I2C_GenerateSTOP(I2C1, ENABLE);
 275              		.loc 1 49 3 is_stmt 1 view .LVU65
 276 006a 0121     		movs	r1, #1
 277 006c 0148     		ldr	r0, .L17
 278 006e FFF7FEFF 		bl	I2C_GenerateSTOP
 279              	.LVL20:
  50:BASIC/i2c/i2c.c **** }
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 7


 280              		.loc 1 50 1 is_stmt 0 view .LVU66
 281 0072 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 282              	.LVL21:
 283              	.L18:
 284              		.loc 1 50 1 view .LVU67
 285              		.align	2
 286              	.L17:
 287 0074 00540040 		.word	1073763328
 288 0078 01000300 		.word	196609
 289 007c 82000700 		.word	458882
 290 0080 84000700 		.word	458884
 291              		.cfi_endproc
 292              	.LFE34:
 294              		.section	.text.I2C_SEND_BYTE,"ax",%progbits
 295              		.align	1
 296              		.global	I2C_SEND_BYTE
 297              		.syntax unified
 298              		.thumb
 299              		.thumb_func
 301              	I2C_SEND_BYTE:
 302              	.LVL22:
 303              	.LFB35:
  51:BASIC/i2c/i2c.c **** void I2C_SEND_BYTE(u8 slaveAddr, u8 writeAddr, u8 pBuffer) {
 304              		.loc 1 51 60 is_stmt 1 view -0
 305              		.cfi_startproc
 306              		@ args = 0, pretend = 0, frame = 0
 307              		@ frame_needed = 0, uses_anonymous_args = 0
 308              		.loc 1 51 60 is_stmt 0 view .LVU69
 309 0000 70B5     		push	{r4, r5, r6, lr}
 310              	.LCFI7:
 311              		.cfi_def_cfa_offset 16
 312              		.cfi_offset 4, -16
 313              		.cfi_offset 5, -12
 314              		.cfi_offset 6, -8
 315              		.cfi_offset 14, -4
 316 0002 0646     		mov	r6, r0
 317 0004 0D46     		mov	r5, r1
 318 0006 1446     		mov	r4, r2
  52:BASIC/i2c/i2c.c ****   I2C_GenerateSTART(I2C1, ENABLE);  //发送开始信号
 319              		.loc 1 52 3 is_stmt 1 view .LVU70
 320 0008 0121     		movs	r1, #1
 321              	.LVL23:
 322              		.loc 1 52 3 is_stmt 0 view .LVU71
 323 000a 1648     		ldr	r0, .L25
 324              	.LVL24:
 325              		.loc 1 52 3 view .LVU72
 326 000c FFF7FEFF 		bl	I2C_GenerateSTART
 327              	.LVL25:
  53:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 328              		.loc 1 53 3 is_stmt 1 view .LVU73
 329              	.L20:
  54:BASIC/i2c/i2c.c ****     ;  //等待完成
 330              		.loc 1 54 5 discriminator 1 view .LVU74
  53:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 331              		.loc 1 53 9 discriminator 1 view .LVU75
  53:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 332              		.loc 1 53 11 is_stmt 0 discriminator 1 view .LVU76
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 8


 333 0010 1549     		ldr	r1, .L25+4
 334 0012 1448     		ldr	r0, .L25
 335 0014 FFF7FEFF 		bl	I2C_CheckEvent
 336              	.LVL26:
  53:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 337              		.loc 1 53 9 discriminator 1 view .LVU77
 338 0018 0028     		cmp	r0, #0
 339 001a F9D0     		beq	.L20
  55:BASIC/i2c/i2c.c ****   I2C_Send7bitAddress(
 340              		.loc 1 55 3 is_stmt 1 view .LVU78
 341 001c 0022     		movs	r2, #0
 342 001e 3146     		mov	r1, r6
 343 0020 1048     		ldr	r0, .L25
 344 0022 FFF7FEFF 		bl	I2C_Send7bitAddress
 345              	.LVL27:
  56:BASIC/i2c/i2c.c ****       I2C1, slaveAddr,
  57:BASIC/i2c/i2c.c ****       I2C_Direction_Transmitter);  //发送从器件地址及状态（写入）
  58:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))
 346              		.loc 1 58 3 view .LVU79
 347              	.L21:
  59:BASIC/i2c/i2c.c ****     ;                             //等待完成
 348              		.loc 1 59 5 discriminator 1 view .LVU80
  58:BASIC/i2c/i2c.c ****     ;                             //等待完成
 349              		.loc 1 58 9 discriminator 1 view .LVU81
  58:BASIC/i2c/i2c.c ****     ;                             //等待完成
 350              		.loc 1 58 11 is_stmt 0 discriminator 1 view .LVU82
 351 0026 1149     		ldr	r1, .L25+8
 352 0028 0E48     		ldr	r0, .L25
 353 002a FFF7FEFF 		bl	I2C_CheckEvent
 354              	.LVL28:
  58:BASIC/i2c/i2c.c ****     ;                             //等待完成
 355              		.loc 1 58 9 discriminator 1 view .LVU83
 356 002e 0028     		cmp	r0, #0
 357 0030 F9D0     		beq	.L21
  60:BASIC/i2c/i2c.c ****   I2C_SendData(I2C1, writeAddr);  //发送从器件内部寄存器地址
 358              		.loc 1 60 3 is_stmt 1 view .LVU84
 359 0032 2946     		mov	r1, r5
 360 0034 0B48     		ldr	r0, .L25
 361 0036 FFF7FEFF 		bl	I2C_SendData
 362              	.LVL29:
  61:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 363              		.loc 1 61 3 view .LVU85
 364              	.L22:
  62:BASIC/i2c/i2c.c ****     ;                           //等待完成
 365              		.loc 1 62 5 discriminator 1 view .LVU86
  61:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 366              		.loc 1 61 9 discriminator 1 view .LVU87
  61:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 367              		.loc 1 61 11 is_stmt 0 discriminator 1 view .LVU88
 368 003a 0D49     		ldr	r1, .L25+12
 369 003c 0948     		ldr	r0, .L25
 370 003e FFF7FEFF 		bl	I2C_CheckEvent
 371              	.LVL30:
  61:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 372              		.loc 1 61 9 discriminator 1 view .LVU89
 373 0042 0028     		cmp	r0, #0
 374 0044 F9D0     		beq	.L22
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 9


  63:BASIC/i2c/i2c.c ****   I2C_SendData(I2C1, pBuffer);  //发送要写入的内容
 375              		.loc 1 63 3 is_stmt 1 view .LVU90
 376 0046 2146     		mov	r1, r4
 377 0048 0648     		ldr	r0, .L25
 378 004a FFF7FEFF 		bl	I2C_SendData
 379              	.LVL31:
  64:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 380              		.loc 1 64 3 view .LVU91
 381              	.L23:
  65:BASIC/i2c/i2c.c ****     ;                              //等待完成
 382              		.loc 1 65 5 discriminator 1 view .LVU92
  64:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 383              		.loc 1 64 9 discriminator 1 view .LVU93
  64:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 384              		.loc 1 64 11 is_stmt 0 discriminator 1 view .LVU94
 385 004e 0849     		ldr	r1, .L25+12
 386 0050 0448     		ldr	r0, .L25
 387 0052 FFF7FEFF 		bl	I2C_CheckEvent
 388              	.LVL32:
  64:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 389              		.loc 1 64 9 discriminator 1 view .LVU95
 390 0056 0028     		cmp	r0, #0
 391 0058 F9D0     		beq	.L23
  66:BASIC/i2c/i2c.c ****   I2C_GenerateSTOP(I2C1, ENABLE);  //发送结束信号
 392              		.loc 1 66 3 is_stmt 1 view .LVU96
 393 005a 0121     		movs	r1, #1
 394 005c 0148     		ldr	r0, .L25
 395 005e FFF7FEFF 		bl	I2C_GenerateSTOP
 396              	.LVL33:
  67:BASIC/i2c/i2c.c **** }
 397              		.loc 1 67 1 is_stmt 0 view .LVU97
 398 0062 70BD     		pop	{r4, r5, r6, pc}
 399              	.L26:
 400              		.align	2
 401              	.L25:
 402 0064 00540040 		.word	1073763328
 403 0068 01000300 		.word	196609
 404 006c 82000700 		.word	458882
 405 0070 84000700 		.word	458884
 406              		.cfi_endproc
 407              	.LFE35:
 409              		.section	.text.I2C_READ_BUFFER,"ax",%progbits
 410              		.align	1
 411              		.global	I2C_READ_BUFFER
 412              		.syntax unified
 413              		.thumb
 414              		.thumb_func
 416              	I2C_READ_BUFFER:
 417              	.LVL34:
 418              	.LFB36:
  68:BASIC/i2c/i2c.c **** void I2C_READ_BUFFER(u8 slaveAddr, u8 readAddr, u8* pBuffer,
  69:BASIC/i2c/i2c.c ****                      u16 numByteToRead) {
 419              		.loc 1 69 41 is_stmt 1 view -0
 420              		.cfi_startproc
 421              		@ args = 0, pretend = 0, frame = 0
 422              		@ frame_needed = 0, uses_anonymous_args = 0
 423              		.loc 1 69 41 is_stmt 0 view .LVU99
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 10


 424 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 425              	.LCFI8:
 426              		.cfi_def_cfa_offset 24
 427              		.cfi_offset 4, -24
 428              		.cfi_offset 5, -20
 429              		.cfi_offset 6, -16
 430              		.cfi_offset 7, -12
 431              		.cfi_offset 8, -8
 432              		.cfi_offset 14, -4
 433 0004 0446     		mov	r4, r0
 434 0006 0F46     		mov	r7, r1
 435 0008 1646     		mov	r6, r2
 436 000a 1D46     		mov	r5, r3
  70:BASIC/i2c/i2c.c ****   while (I2C_GetFlagStatus(I2C1, I2C_FLAG_BUSY))
 437              		.loc 1 70 3 is_stmt 1 view .LVU100
 438              	.LVL35:
 439              	.L28:
  71:BASIC/i2c/i2c.c ****     ;
 440              		.loc 1 71 5 discriminator 1 view .LVU101
  70:BASIC/i2c/i2c.c ****   while (I2C_GetFlagStatus(I2C1, I2C_FLAG_BUSY))
 441              		.loc 1 70 9 discriminator 1 view .LVU102
  70:BASIC/i2c/i2c.c ****   while (I2C_GetFlagStatus(I2C1, I2C_FLAG_BUSY))
 442              		.loc 1 70 10 is_stmt 0 discriminator 1 view .LVU103
 443 000c 4FF40031 		mov	r1, #131072
 444 0010 3048     		ldr	r0, .L41
 445 0012 FFF7FEFF 		bl	I2C_GetFlagStatus
 446              	.LVL36:
  70:BASIC/i2c/i2c.c ****   while (I2C_GetFlagStatus(I2C1, I2C_FLAG_BUSY))
 447              		.loc 1 70 9 discriminator 1 view .LVU104
 448 0016 0028     		cmp	r0, #0
 449 0018 F8D1     		bne	.L28
  72:BASIC/i2c/i2c.c ****   I2C_GenerateSTART(I2C1, ENABLE);
 450              		.loc 1 72 3 is_stmt 1 view .LVU105
 451 001a 0121     		movs	r1, #1
 452 001c 2D48     		ldr	r0, .L41
 453 001e FFF7FEFF 		bl	I2C_GenerateSTART
 454              	.LVL37:
  73:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 455              		.loc 1 73 3 view .LVU106
 456              	.L29:
  74:BASIC/i2c/i2c.c ****     ;
 457              		.loc 1 74 5 discriminator 1 view .LVU107
  73:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 458              		.loc 1 73 9 discriminator 1 view .LVU108
  73:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 459              		.loc 1 73 11 is_stmt 0 discriminator 1 view .LVU109
 460 0022 2D49     		ldr	r1, .L41+4
 461 0024 2B48     		ldr	r0, .L41
 462 0026 FFF7FEFF 		bl	I2C_CheckEvent
 463              	.LVL38:
  73:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 464              		.loc 1 73 9 discriminator 1 view .LVU110
 465 002a 0028     		cmp	r0, #0
 466 002c F9D0     		beq	.L29
  75:BASIC/i2c/i2c.c ****   I2C_Send7bitAddress(I2C1, slaveAddr, I2C_Direction_Transmitter);
 467              		.loc 1 75 3 is_stmt 1 view .LVU111
 468 002e 0022     		movs	r2, #0
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 11


 469 0030 2146     		mov	r1, r4
 470 0032 2848     		ldr	r0, .L41
 471 0034 FFF7FEFF 		bl	I2C_Send7bitAddress
 472              	.LVL39:
  76:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))
 473              		.loc 1 76 3 view .LVU112
 474              	.L30:
  77:BASIC/i2c/i2c.c ****     ;
 475              		.loc 1 77 5 discriminator 1 view .LVU113
  76:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))
 476              		.loc 1 76 9 discriminator 1 view .LVU114
  76:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))
 477              		.loc 1 76 11 is_stmt 0 discriminator 1 view .LVU115
 478 0038 2849     		ldr	r1, .L41+8
 479 003a 2648     		ldr	r0, .L41
 480 003c FFF7FEFF 		bl	I2C_CheckEvent
 481              	.LVL40:
  76:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))
 482              		.loc 1 76 9 discriminator 1 view .LVU116
 483 0040 0028     		cmp	r0, #0
 484 0042 F9D0     		beq	.L30
  78:BASIC/i2c/i2c.c ****   I2C_Cmd(I2C1, ENABLE);
 485              		.loc 1 78 3 is_stmt 1 view .LVU117
 486 0044 DFF88C80 		ldr	r8, .L41
 487 0048 0121     		movs	r1, #1
 488 004a 4046     		mov	r0, r8
 489 004c FFF7FEFF 		bl	I2C_Cmd
 490              	.LVL41:
  79:BASIC/i2c/i2c.c ****   I2C_SendData(I2C1, readAddr);
 491              		.loc 1 79 3 view .LVU118
 492 0050 3946     		mov	r1, r7
 493 0052 4046     		mov	r0, r8
 494 0054 FFF7FEFF 		bl	I2C_SendData
 495              	.LVL42:
  80:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 496              		.loc 1 80 3 view .LVU119
 497              	.L31:
  81:BASIC/i2c/i2c.c ****     ;
 498              		.loc 1 81 5 discriminator 1 view .LVU120
  80:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 499              		.loc 1 80 9 discriminator 1 view .LVU121
  80:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 500              		.loc 1 80 11 is_stmt 0 discriminator 1 view .LVU122
 501 0058 2149     		ldr	r1, .L41+12
 502 005a 1E48     		ldr	r0, .L41
 503 005c FFF7FEFF 		bl	I2C_CheckEvent
 504              	.LVL43:
  80:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 505              		.loc 1 80 9 discriminator 1 view .LVU123
 506 0060 0028     		cmp	r0, #0
 507 0062 F9D0     		beq	.L31
  82:BASIC/i2c/i2c.c ****   I2C_GenerateSTART(I2C1, ENABLE);
 508              		.loc 1 82 3 is_stmt 1 view .LVU124
 509 0064 0121     		movs	r1, #1
 510 0066 1B48     		ldr	r0, .L41
 511 0068 FFF7FEFF 		bl	I2C_GenerateSTART
 512              	.LVL44:
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 12


  83:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 513              		.loc 1 83 3 view .LVU125
 514              	.L32:
  84:BASIC/i2c/i2c.c ****     ;
 515              		.loc 1 84 5 discriminator 1 view .LVU126
  83:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 516              		.loc 1 83 9 discriminator 1 view .LVU127
  83:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 517              		.loc 1 83 11 is_stmt 0 discriminator 1 view .LVU128
 518 006c 1A49     		ldr	r1, .L41+4
 519 006e 1948     		ldr	r0, .L41
 520 0070 FFF7FEFF 		bl	I2C_CheckEvent
 521              	.LVL45:
  83:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 522              		.loc 1 83 9 discriminator 1 view .LVU129
 523 0074 0028     		cmp	r0, #0
 524 0076 F9D0     		beq	.L32
  85:BASIC/i2c/i2c.c ****   I2C_Send7bitAddress(I2C1, slaveAddr, I2C_Direction_Receiver);
 525              		.loc 1 85 3 is_stmt 1 view .LVU130
 526 0078 0122     		movs	r2, #1
 527 007a 2146     		mov	r1, r4
 528 007c 1548     		ldr	r0, .L41
 529 007e FFF7FEFF 		bl	I2C_Send7bitAddress
 530              	.LVL46:
  86:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED))
 531              		.loc 1 86 3 view .LVU131
 532              	.L33:
  87:BASIC/i2c/i2c.c ****     ;
 533              		.loc 1 87 5 discriminator 1 view .LVU132
  86:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED))
 534              		.loc 1 86 9 discriminator 1 view .LVU133
  86:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED))
 535              		.loc 1 86 11 is_stmt 0 discriminator 1 view .LVU134
 536 0082 1849     		ldr	r1, .L41+16
 537 0084 1348     		ldr	r0, .L41
 538 0086 FFF7FEFF 		bl	I2C_CheckEvent
 539              	.LVL47:
  86:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED))
 540              		.loc 1 86 9 discriminator 1 view .LVU135
 541 008a 0028     		cmp	r0, #0
 542 008c F9D0     		beq	.L33
 543              	.LBB3:
  88:BASIC/i2c/i2c.c ****   for (u16 i = 0; i < numByteToRead;) {
 544              		.loc 1 88 12 view .LVU136
 545 008e 0024     		movs	r4, #0
 546 0090 04E0     		b	.L36
 547              	.LVL48:
 548              	.L35:
  89:BASIC/i2c/i2c.c ****     if (i == numByteToRead - 1) {
  90:BASIC/i2c/i2c.c ****       I2C_AcknowledgeConfig(I2C1, DISABLE);
  91:BASIC/i2c/i2c.c ****       I2C_GenerateSTOP(I2C1, ENABLE);
  92:BASIC/i2c/i2c.c ****     }
  93:BASIC/i2c/i2c.c ****     if (I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_RECEIVED)) {
 549              		.loc 1 93 5 is_stmt 1 view .LVU137
 550              		.loc 1 93 9 is_stmt 0 view .LVU138
 551 0092 1549     		ldr	r1, .L41+20
 552 0094 0F48     		ldr	r0, .L41
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 13


 553 0096 FFF7FEFF 		bl	I2C_CheckEvent
 554              	.LVL49:
 555              		.loc 1 93 8 view .LVU139
 556 009a 70B9     		cbnz	r0, .L39
 557              	.LVL50:
 558              	.L36:
  88:BASIC/i2c/i2c.c ****   for (u16 i = 0; i < numByteToRead;) {
 559              		.loc 1 88 19 is_stmt 1 discriminator 1 view .LVU140
  88:BASIC/i2c/i2c.c ****   for (u16 i = 0; i < numByteToRead;) {
 560              		.loc 1 88 3 is_stmt 0 discriminator 1 view .LVU141
 561 009c AC42     		cmp	r4, r5
 562 009e 13D2     		bcs	.L40
  89:BASIC/i2c/i2c.c ****     if (i == numByteToRead - 1) {
 563              		.loc 1 89 5 is_stmt 1 view .LVU142
  89:BASIC/i2c/i2c.c ****     if (i == numByteToRead - 1) {
 564              		.loc 1 89 28 is_stmt 0 view .LVU143
 565 00a0 6B1E     		subs	r3, r5, #1
  89:BASIC/i2c/i2c.c ****     if (i == numByteToRead - 1) {
 566              		.loc 1 89 8 view .LVU144
 567 00a2 9C42     		cmp	r4, r3
 568 00a4 F5D1     		bne	.L35
  90:BASIC/i2c/i2c.c ****       I2C_GenerateSTOP(I2C1, ENABLE);
 569              		.loc 1 90 7 is_stmt 1 view .LVU145
 570 00a6 0B4F     		ldr	r7, .L41
 571 00a8 0021     		movs	r1, #0
 572 00aa 3846     		mov	r0, r7
 573 00ac FFF7FEFF 		bl	I2C_AcknowledgeConfig
 574              	.LVL51:
  91:BASIC/i2c/i2c.c ****     }
 575              		.loc 1 91 7 view .LVU146
 576 00b0 0121     		movs	r1, #1
 577 00b2 3846     		mov	r0, r7
 578 00b4 FFF7FEFF 		bl	I2C_GenerateSTOP
 579              	.LVL52:
 580 00b8 EBE7     		b	.L35
 581              	.L39:
  94:BASIC/i2c/i2c.c ****       *(pBuffer + i) = I2C_ReceiveData(I2C1);
 582              		.loc 1 94 7 view .LVU147
 583              		.loc 1 94 24 is_stmt 0 view .LVU148
 584 00ba 0648     		ldr	r0, .L41
 585 00bc FFF7FEFF 		bl	I2C_ReceiveData
 586              	.LVL53:
 587              		.loc 1 94 22 view .LVU149
 588 00c0 3055     		strb	r0, [r6, r4]
  95:BASIC/i2c/i2c.c ****       // i++必须放在这边，只有当成功读取到一条数据后才能读取下一个数据
  96:BASIC/i2c/i2c.c ****       // 否则执行空循环
  97:BASIC/i2c/i2c.c ****       i++;
 589              		.loc 1 97 7 is_stmt 1 view .LVU150
 590              		.loc 1 97 8 is_stmt 0 view .LVU151
 591 00c2 0134     		adds	r4, r4, #1
 592              	.LVL54:
 593              		.loc 1 97 8 view .LVU152
 594 00c4 A4B2     		uxth	r4, r4
 595              	.LVL55:
 596              		.loc 1 97 8 view .LVU153
 597 00c6 E9E7     		b	.L36
 598              	.L40:
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 14


 599              		.loc 1 97 8 view .LVU154
 600              	.LBE3:
  98:BASIC/i2c/i2c.c ****     }
  99:BASIC/i2c/i2c.c ****   }
 100:BASIC/i2c/i2c.c ****   I2C_AcknowledgeConfig(I2C1, ENABLE);
 601              		.loc 1 100 3 is_stmt 1 view .LVU155
 602 00c8 0121     		movs	r1, #1
 603 00ca 0248     		ldr	r0, .L41
 604 00cc FFF7FEFF 		bl	I2C_AcknowledgeConfig
 605              	.LVL56:
 101:BASIC/i2c/i2c.c **** }
 606              		.loc 1 101 1 is_stmt 0 view .LVU156
 607 00d0 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 608              	.LVL57:
 609              	.L42:
 610              		.loc 1 101 1 view .LVU157
 611              		.align	2
 612              	.L41:
 613 00d4 00540040 		.word	1073763328
 614 00d8 01000300 		.word	196609
 615 00dc 82000700 		.word	458882
 616 00e0 84000700 		.word	458884
 617 00e4 02000300 		.word	196610
 618 00e8 40000300 		.word	196672
 619              		.cfi_endproc
 620              	.LFE36:
 622              		.section	.text.I2C_READ_BYTE,"ax",%progbits
 623              		.align	1
 624              		.global	I2C_READ_BYTE
 625              		.syntax unified
 626              		.thumb
 627              		.thumb_func
 629              	I2C_READ_BYTE:
 630              	.LVL58:
 631              	.LFB37:
 102:BASIC/i2c/i2c.c **** 
 103:BASIC/i2c/i2c.c **** u8 I2C_READ_BYTE(u8 slaveAddr, u8 readAddr) {
 632              		.loc 1 103 45 is_stmt 1 view -0
 633              		.cfi_startproc
 634              		@ args = 0, pretend = 0, frame = 0
 635              		@ frame_needed = 0, uses_anonymous_args = 0
 636              		.loc 1 103 45 is_stmt 0 view .LVU159
 637 0000 70B5     		push	{r4, r5, r6, lr}
 638              	.LCFI9:
 639              		.cfi_def_cfa_offset 16
 640              		.cfi_offset 4, -16
 641              		.cfi_offset 5, -12
 642              		.cfi_offset 6, -8
 643              		.cfi_offset 14, -4
 644 0002 0446     		mov	r4, r0
 645 0004 0D46     		mov	r5, r1
 104:BASIC/i2c/i2c.c ****   u8 a;
 646              		.loc 1 104 3 is_stmt 1 view .LVU160
 105:BASIC/i2c/i2c.c ****   while (I2C_GetFlagStatus(I2C1, I2C_FLAG_BUSY))
 647              		.loc 1 105 3 view .LVU161
 648              	.LVL59:
 649              	.L44:
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 15


 106:BASIC/i2c/i2c.c ****     ;
 650              		.loc 1 106 5 discriminator 1 view .LVU162
 105:BASIC/i2c/i2c.c ****   while (I2C_GetFlagStatus(I2C1, I2C_FLAG_BUSY))
 651              		.loc 1 105 9 discriminator 1 view .LVU163
 105:BASIC/i2c/i2c.c ****   while (I2C_GetFlagStatus(I2C1, I2C_FLAG_BUSY))
 652              		.loc 1 105 10 is_stmt 0 discriminator 1 view .LVU164
 653 0006 4FF40031 		mov	r1, #131072
 654 000a 2548     		ldr	r0, .L51
 655 000c FFF7FEFF 		bl	I2C_GetFlagStatus
 656              	.LVL60:
 105:BASIC/i2c/i2c.c ****   while (I2C_GetFlagStatus(I2C1, I2C_FLAG_BUSY))
 657              		.loc 1 105 9 discriminator 1 view .LVU165
 658 0010 0028     		cmp	r0, #0
 659 0012 F8D1     		bne	.L44
 107:BASIC/i2c/i2c.c ****   I2C_GenerateSTART(I2C1, ENABLE);
 660              		.loc 1 107 3 is_stmt 1 view .LVU166
 661 0014 0121     		movs	r1, #1
 662 0016 2248     		ldr	r0, .L51
 663 0018 FFF7FEFF 		bl	I2C_GenerateSTART
 664              	.LVL61:
 108:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 665              		.loc 1 108 3 view .LVU167
 666              	.L45:
 109:BASIC/i2c/i2c.c ****     ;
 667              		.loc 1 109 5 discriminator 1 view .LVU168
 108:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 668              		.loc 1 108 9 discriminator 1 view .LVU169
 108:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 669              		.loc 1 108 11 is_stmt 0 discriminator 1 view .LVU170
 670 001c 2149     		ldr	r1, .L51+4
 671 001e 2048     		ldr	r0, .L51
 672 0020 FFF7FEFF 		bl	I2C_CheckEvent
 673              	.LVL62:
 108:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 674              		.loc 1 108 9 discriminator 1 view .LVU171
 675 0024 0028     		cmp	r0, #0
 676 0026 F9D0     		beq	.L45
 110:BASIC/i2c/i2c.c ****   I2C_Send7bitAddress(I2C1, slaveAddr, I2C_Direction_Transmitter);
 677              		.loc 1 110 3 is_stmt 1 view .LVU172
 678 0028 0022     		movs	r2, #0
 679 002a 2146     		mov	r1, r4
 680 002c 1C48     		ldr	r0, .L51
 681 002e FFF7FEFF 		bl	I2C_Send7bitAddress
 682              	.LVL63:
 111:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))
 683              		.loc 1 111 3 view .LVU173
 684              	.L46:
 112:BASIC/i2c/i2c.c ****     ;
 685              		.loc 1 112 5 discriminator 1 view .LVU174
 111:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))
 686              		.loc 1 111 9 discriminator 1 view .LVU175
 111:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))
 687              		.loc 1 111 11 is_stmt 0 discriminator 1 view .LVU176
 688 0032 1D49     		ldr	r1, .L51+8
 689 0034 1A48     		ldr	r0, .L51
 690 0036 FFF7FEFF 		bl	I2C_CheckEvent
 691              	.LVL64:
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 16


 111:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED))
 692              		.loc 1 111 9 discriminator 1 view .LVU177
 693 003a 0028     		cmp	r0, #0
 694 003c F9D0     		beq	.L46
 113:BASIC/i2c/i2c.c ****   I2C_Cmd(I2C1, ENABLE);
 695              		.loc 1 113 3 is_stmt 1 view .LVU178
 696 003e 184E     		ldr	r6, .L51
 697 0040 0121     		movs	r1, #1
 698 0042 3046     		mov	r0, r6
 699 0044 FFF7FEFF 		bl	I2C_Cmd
 700              	.LVL65:
 114:BASIC/i2c/i2c.c ****   I2C_SendData(I2C1, readAddr);
 701              		.loc 1 114 3 view .LVU179
 702 0048 2946     		mov	r1, r5
 703 004a 3046     		mov	r0, r6
 704 004c FFF7FEFF 		bl	I2C_SendData
 705              	.LVL66:
 115:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 706              		.loc 1 115 3 view .LVU180
 707              	.L47:
 116:BASIC/i2c/i2c.c ****     ;
 708              		.loc 1 116 5 discriminator 1 view .LVU181
 115:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 709              		.loc 1 115 9 discriminator 1 view .LVU182
 115:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 710              		.loc 1 115 11 is_stmt 0 discriminator 1 view .LVU183
 711 0050 1649     		ldr	r1, .L51+12
 712 0052 1348     		ldr	r0, .L51
 713 0054 FFF7FEFF 		bl	I2C_CheckEvent
 714              	.LVL67:
 115:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_BYTE_TRANSMITTED))
 715              		.loc 1 115 9 discriminator 1 view .LVU184
 716 0058 0028     		cmp	r0, #0
 717 005a F9D0     		beq	.L47
 117:BASIC/i2c/i2c.c ****   I2C_GenerateSTART(I2C1, ENABLE);
 718              		.loc 1 117 3 is_stmt 1 view .LVU185
 719 005c 0121     		movs	r1, #1
 720 005e 1048     		ldr	r0, .L51
 721 0060 FFF7FEFF 		bl	I2C_GenerateSTART
 722              	.LVL68:
 118:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 723              		.loc 1 118 3 view .LVU186
 724              	.L48:
 119:BASIC/i2c/i2c.c ****     ;
 725              		.loc 1 119 5 discriminator 1 view .LVU187
 118:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 726              		.loc 1 118 9 discriminator 1 view .LVU188
 118:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 727              		.loc 1 118 11 is_stmt 0 discriminator 1 view .LVU189
 728 0064 0F49     		ldr	r1, .L51+4
 729 0066 0E48     		ldr	r0, .L51
 730 0068 FFF7FEFF 		bl	I2C_CheckEvent
 731              	.LVL69:
 118:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_MODE_SELECT))
 732              		.loc 1 118 9 discriminator 1 view .LVU190
 733 006c 0028     		cmp	r0, #0
 734 006e F9D0     		beq	.L48
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 17


 120:BASIC/i2c/i2c.c ****   I2C_Send7bitAddress(I2C1, slaveAddr, I2C_Direction_Receiver);
 735              		.loc 1 120 3 is_stmt 1 view .LVU191
 736 0070 0122     		movs	r2, #1
 737 0072 2146     		mov	r1, r4
 738 0074 0A48     		ldr	r0, .L51
 739 0076 FFF7FEFF 		bl	I2C_Send7bitAddress
 740              	.LVL70:
 121:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED))
 741              		.loc 1 121 3 view .LVU192
 742              	.L49:
 122:BASIC/i2c/i2c.c ****     ;
 743              		.loc 1 122 5 discriminator 1 view .LVU193
 121:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED))
 744              		.loc 1 121 9 discriminator 1 view .LVU194
 121:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED))
 745              		.loc 1 121 11 is_stmt 0 discriminator 1 view .LVU195
 746 007a 0D49     		ldr	r1, .L51+16
 747 007c 0848     		ldr	r0, .L51
 748 007e FFF7FEFF 		bl	I2C_CheckEvent
 749              	.LVL71:
 121:BASIC/i2c/i2c.c ****   while (!I2C_CheckEvent(I2C1, I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED))
 750              		.loc 1 121 9 discriminator 1 view .LVU196
 751 0082 0028     		cmp	r0, #0
 752 0084 F9D0     		beq	.L49
 123:BASIC/i2c/i2c.c ****   I2C_AcknowledgeConfig(I2C1, DISABLE);  //最后有一个数据时关闭应答位
 753              		.loc 1 123 3 is_stmt 1 view .LVU197
 754 0086 064C     		ldr	r4, .L51
 755 0088 0021     		movs	r1, #0
 756 008a 2046     		mov	r0, r4
 757 008c FFF7FEFF 		bl	I2C_AcknowledgeConfig
 758              	.LVL72:
 124:BASIC/i2c/i2c.c ****   I2C_GenerateSTOP(I2C1, ENABLE);        //最后一个数据时使能停止位
 759              		.loc 1 124 3 view .LVU198
 760 0090 0121     		movs	r1, #1
 761 0092 2046     		mov	r0, r4
 762 0094 FFF7FEFF 		bl	I2C_GenerateSTOP
 763              	.LVL73:
 125:BASIC/i2c/i2c.c ****   a = I2C_ReceiveData(I2C1);
 764              		.loc 1 125 3 view .LVU199
 765              		.loc 1 125 7 is_stmt 0 view .LVU200
 766 0098 2046     		mov	r0, r4
 767 009a FFF7FEFF 		bl	I2C_ReceiveData
 768              	.LVL74:
 126:BASIC/i2c/i2c.c ****   return a;
 769              		.loc 1 126 3 is_stmt 1 view .LVU201
 127:BASIC/i2c/i2c.c **** }...
 770              		.loc 1 127 1 is_stmt 0 view .LVU202
 771 009e 70BD     		pop	{r4, r5, r6, pc}
 772              	.L52:
 773              		.align	2
 774              	.L51:
 775 00a0 00540040 		.word	1073763328
 776 00a4 01000300 		.word	196609
 777 00a8 82000700 		.word	458882
 778 00ac 84000700 		.word	458884
 779 00b0 02000300 		.word	196610
 780              		.cfi_endproc
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 18


 781              	.LFE37:
 783              		.text
 784              	.Letext0:
 785              		.file 2 "c:\\develop\\gcc-arm-none-eabi\\arm-none-eabi\\include\\machine\\_default_types.h"
 786              		.file 3 "c:\\develop\\gcc-arm-none-eabi\\arm-none-eabi\\include\\sys\\_stdint.h"
 787              		.file 4 "CMSIS/stm32f10x.h"
 788              		.file 5 "LIB/inc/stm32f10x_i2c.h"
 789              		.file 6 "LIB/inc/stm32f10x_gpio.h"
 790              		.file 7 "LIB/inc/stm32f10x_rcc.h"
ARM GAS  C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s 			page 19


DEFINED SYMBOLS
                            *ABS*:00000000 i2c.c
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:18     .text.I2C_GPIO_Init:00000000 $t
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:24     .text.I2C_GPIO_Init:00000000 I2C_GPIO_Init
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:75     .text.I2C_GPIO_Init:00000038 $d
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:80     .text.I2C_Configuration:00000000 $t
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:86     .text.I2C_Configuration:00000000 I2C_Configuration
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:148    .text.I2C_Configuration:00000048 $d
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:154    .text.I2C_SEND_BUFFER:00000000 $t
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:160    .text.I2C_SEND_BUFFER:00000000 I2C_SEND_BUFFER
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:287    .text.I2C_SEND_BUFFER:00000074 $d
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:295    .text.I2C_SEND_BYTE:00000000 $t
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:301    .text.I2C_SEND_BYTE:00000000 I2C_SEND_BYTE
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:402    .text.I2C_SEND_BYTE:00000064 $d
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:410    .text.I2C_READ_BUFFER:00000000 $t
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:416    .text.I2C_READ_BUFFER:00000000 I2C_READ_BUFFER
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:613    .text.I2C_READ_BUFFER:000000d4 $d
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:623    .text.I2C_READ_BYTE:00000000 $t
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:629    .text.I2C_READ_BYTE:00000000 I2C_READ_BYTE
C:\Users\Rick\AppData\Local\Temp\cctuC9Gr.s:775    .text.I2C_READ_BYTE:000000a0 $d

UNDEFINED SYMBOLS
RCC_APB2PeriphClockCmd
RCC_APB1PeriphClockCmd
GPIO_Init
I2C_Init
I2C_Cmd
I2C_GenerateSTART
I2C_CheckEvent
I2C_Send7bitAddress
I2C_SendData
I2C_GenerateSTOP
I2C_GetFlagStatus
I2C_AcknowledgeConfig
I2C_ReceiveData
